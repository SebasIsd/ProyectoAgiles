@page "/logout"
@layout Facturacion.Blazor.Components.MainLayout
@inject AuthService Auth
@inject NavigationManager Nav

<PageTitle>Cerrando Sesión...</PageTitle>

<div class="d-flex flex-column align-items-center justify-content-center" style="height: 60vh;">
    <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
        <span class="visually-hidden">Cerrando sesión...</span>
    </div>
    <h4 class="mt-3 text-muted">Cerrando sesión, por favor espera...</h4>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        // 1. Ejecuta la lógica de cierre de sesión
        Auth.LogoutAsync();

        // Pequeño retraso para dar tiempo a la UI/AuthStateProvider a actualizarse
        await Task.Delay(500);

        // 2. Redirige al usuario a la página de login
        Nav.NavigateTo("/login");
    }
}